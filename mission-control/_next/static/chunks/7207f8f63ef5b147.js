(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";let t;var r,a,n,l,i,s,o,d,c,u,g,h,x,m,f,p,b,v,y,k=e.i(43476),w=e.i(71645);async function j(e,t){let r=`https://heather-duplicate-having-domestic.trycloudflare.com${e}${e.includes("?")?"":"/"}`,a=await fetch(r,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!a.ok)throw Error(`API error: ${a.status}`);return a.json()}e.i(47167);let N=e=>j("/api/tasks",{method:"POST",body:JSON.stringify(e)}),C=(e,t)=>j("/api/tasks",{method:"PUT",body:JSON.stringify({id:e,...t})}),S=(e,t)=>j("/api/projects",{method:"PUT",body:JSON.stringify({id:e,...t})});function E(e){let t=Math.floor((Date.now()-new Date(e).getTime())/1e3);if(t<60)return"just now";let r=Math.floor(t/60);if(r<60)return`${r}m ago`;let a=Math.floor(r/60);if(a<24)return`${a}h ago`;let n=Math.floor(a/24);return`${n}d ago`}let M=[{id:"tasks",label:"Tasks",icon:(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})},{id:"projects",label:"Projects",icon:(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"})})},{id:"automations",label:"Automations",icon:(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"})})},{id:"team",label:"Team",icon:(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})})}];function D({activeTab:e,onTabChange:t}){let[r,a]=(0,w.useState)(!1);return(0,k.jsxs)("aside",{className:`hidden md:flex flex-col ${r?"w-16":"w-56"} bg-white/80 dark:bg-gray-900/40 backdrop-blur-xl border-r border-gray-200 dark:border-gray-800/50 transition-all duration-300 ease-in-out flex-shrink-0`,children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800/50",children:[!r&&(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-lg",children:"⚡"}),(0,k.jsx)("span",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:"Mission Control"})]}),(0,k.jsx)("button",{onClick:()=>a(!r),className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800/60 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors min-w-[36px] min-h-[36px] flex items-center justify-center",children:(0,k.jsx)("svg",{className:`w-4 h-4 transition-transform duration-300 ${r?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})})]}),(0,k.jsx)("nav",{className:"flex-1 p-3 space-y-1",children:M.map(a=>(0,k.jsxs)("a",{href:`#${a.id}`,onClick:e=>{e.preventDefault(),t(a.id)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 min-h-[44px] ${e===a.id?"bg-amber-500/10 text-amber-500 dark:text-amber-400 border border-amber-500/20":"text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800/40"}`,title:r?a.label:void 0,children:[a.icon,!r&&(0,k.jsx)("span",{children:a.label})]},a.id))}),!r&&(0,k.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-800/50",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-xs font-bold text-gray-950",children:"E"}),(0,k.jsxs)("div",{className:"text-xs",children:[(0,k.jsx)("div",{className:"text-gray-700 dark:text-gray-300 font-medium",children:"Ephraim"}),(0,k.jsx)("div",{className:"text-gray-400 dark:text-gray-500",children:"Owner"})]})]})})]})}var T=e.i(50208);function L({onMenuToggle:e}){let{mode:t,cycle:r}=(0,T.useTheme)(),a="dark"===t?(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"})}):"light"===t?(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"})}):(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25A2.25 2.25 0 015.25 3h13.5A2.25 2.25 0 0121 5.25z"})}),n="dark"===t?"Dark":"light"===t?"Light":"System";return(0,k.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 bg-white/80 dark:bg-gray-900/60 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800/50",children:[(0,k.jsx)("button",{onClick:e,className:"md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800/60 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",children:(0,k.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),(0,k.jsxs)("div",{className:"flex items-center gap-2 md:hidden",children:[(0,k.jsx)("span",{className:"text-lg",children:"⚡"}),(0,k.jsx)("span",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:"Mission Control"})]}),(0,k.jsx)("div",{className:"hidden md:block"}),(0,k.jsxs)("button",{onClick:r,className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800/60 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors min-w-[44px] min-h-[44px] justify-center",title:`Theme: ${n}`,children:[a,(0,k.jsx)("span",{className:"text-xs font-medium hidden sm:inline",children:n})]})]})}function R({tasks:e}){let t=e.filter(e=>"archived"!==e.column&&"suggested"!==e.column),r=e.filter(e=>"suggested"===e.column).length,a=t.filter(e=>"in-progress"===e.column).length,n=t.filter(e=>"done"===e.column).length,l=t.length,i=e.filter(e=>"archived"===e.column).length,s=l>0?Math.round(n/l*100):0,o=[...r>0?[{label:"Suggested",value:r.toString(),color:"text-purple-400"}]:[],{label:"Approved",value:l.toString(),color:"text-gray-900 dark:text-gray-100"},{label:"In progress",value:a.toString(),color:"text-blue-500 dark:text-blue-400"},{label:"Completion",value:`${s}%`,color:"text-emerald-500 dark:text-emerald-400"},...i>0?[{label:"Archived",value:i.toString(),color:"text-red-500 dark:text-red-400"}]:[]];return(0,k.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-1 lg:grid lg:overflow-x-visible scrollbar-hide",style:{gridTemplateColumns:`repeat(${o.length}, minmax(0, 1fr))`},children:o.map(e=>(0,k.jsxs)("div",{className:"flex-shrink-0 min-w-[120px] lg:min-w-0 bg-white dark:bg-gray-900/40 backdrop-blur-sm border border-gray-200 dark:border-gray-800/50 rounded-xl px-4 py-3",children:[(0,k.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.label}),(0,k.jsx)("div",{className:`text-xl font-bold ${e.color}`,children:e.value})]},e.label))})}function A({selectedAgent:e,selectedProject:t,onAgentChange:r,onProjectChange:a,onNewTask:n,projects:l,tasks:i}){let s=[...new Set(i.map(e=>e.agent).filter(Boolean))];return(0,k.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:flex-wrap lg:items-center",children:[(0,k.jsxs)("button",{onClick:n,className:"w-full lg:w-auto flex items-center justify-center gap-1.5 px-4 py-2 bg-amber-500 hover:bg-amber-400 text-gray-950 font-semibold text-sm rounded-lg transition-colors min-h-[44px]",children:[(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"New task"]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",children:[s.map(t=>(0,k.jsxs)("button",{onClick:()=>r(e===t?null:t),className:`flex-shrink-0 flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium transition-all min-h-[36px] ${e===t?"bg-amber-500/20 text-amber-500 dark:text-amber-400 border border-amber-500/30":"bg-gray-100 dark:bg-gray-800/60 text-gray-500 dark:text-gray-400 border border-gray-300 dark:border-gray-700/50 hover:border-gray-400 dark:hover:border-gray-600/50 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[(0,k.jsx)("span",{className:"w-2 h-2 rounded-full bg-amber-400"}),t]},t)),(0,k.jsxs)("select",{value:t||"",onChange:e=>a(e.target.value||null),className:"flex-shrink-0 bg-gray-100 dark:bg-gray-800/60 border border-gray-300 dark:border-gray-700/50 text-gray-700 dark:text-gray-300 text-xs rounded-lg px-3 py-2 min-h-[36px] focus:outline-none focus:border-amber-500/50 transition-colors",children:[(0,k.jsx)("option",{value:"",children:"All projects"}),l.map(e=>(0,k.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})}var I=e.i(74080);let O="u">typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function P(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function $(e){return"nodeType"in e}function B(e){var t,r;return e?P(e)?e:$(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function W(e){let{Document:t}=B(e);return e instanceof t}function z(e){return!P(e)&&e instanceof B(e).HTMLElement}function F(e){return e instanceof B(e).SVGElement}function U(e){return e?P(e)?e.document:$(e)?W(e)?e:z(e)||F(e)?e.ownerDocument:document:document:document}let H=O?w.useLayoutEffect:w.useEffect;function Y(e){let t=(0,w.useRef)(e);return H(()=>{t.current=e}),(0,w.useCallback)(function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return null==t.current?void 0:t.current(...r)},[])}function X(e,t){void 0===t&&(t=[e]);let r=(0,w.useRef)(e);return H(()=>{r.current!==e&&(r.current=e)},t),r}function K(e,t){let r=(0,w.useRef)();return(0,w.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function V(e){let t=Y(e),r=(0,w.useRef)(null),a=(0,w.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,a]}function J(e){let t=(0,w.useRef)();return(0,w.useEffect)(()=>{t.current=e},[e]),t.current}let _={};function q(e,t){return(0,w.useMemo)(()=>{if(t)return t;let r=null==_[e]?0:_[e]+1;return _[e]=r,e+"-"+r},[e,t])}function G(e){return function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.reduce((t,r)=>{for(let[a,n]of Object.entries(r)){let r=t[a];null!=r&&(t[a]=r+e*n)}return t},{...t})}}let Q=G(1),Z=G(-1);function ee(e){if(!e)return!1;let{KeyboardEvent:t}=B(e.target);return t&&e instanceof t}function et(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=B(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let er=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[er.Translate.toString(e),er.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),ea="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",en={display:"none"};function el(e){let{id:t,value:r}=e;return w.default.createElement("div",{id:t,style:en},r)}function ei(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;return w.default.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":a,"aria-atomic":!0},r)}let es=(0,w.createContext)(null),eo={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},ed={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ec(e){var t;let r,{announcements:a=ed,container:n,hiddenTextDescribedById:l,screenReaderInstructions:i=eo}=e,{announce:s,announcement:o}=function(){let[e,t]=(0,w.useState)("");return{announce:(0,w.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),d=q("DndLiveRegion"),[c,u]=(0,w.useState)(!1);if((0,w.useEffect)(()=>{u(!0)},[]),t=(0,w.useMemo)(()=>({onDragStart(e){let{active:t}=e;s(a.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;a.onDragMove&&s(a.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;s(a.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;s(a.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;s(a.onDragCancel({active:t,over:r}))}}),[s,a]),r=(0,w.useContext)(es),(0,w.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!c)return null;let g=w.default.createElement(w.default.Fragment,null,w.default.createElement(el,{id:l,value:i.draggable}),w.default.createElement(ei,{id:d,announcement:o}));return n?(0,I.createPortal)(g,n):g}function eu(){}function eg(e,t){return(0,w.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(r=u||(u={})).DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable";let eh=Object.freeze({x:0,y:0});function ex(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function em(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function ef(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}let ep=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=ef(t,t.left,t.top),l=[];for(let e of a){let{id:t}=e,a=r.get(t);if(a){var i;let r=(i=ef(a),Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)));l.push({id:t,data:{droppableContainer:e,value:r}})}}return l.sort(ex)},eb=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=[];for(let e of a){let{id:a}=e,l=r.get(a);if(l){let r=function(e,t){let r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),n=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height);if(a<n&&r<l){let i=t.width*t.height,s=e.width*e.height,o=(n-a)*(l-r);return Number((o/(i+s-o)).toFixed(4))}return 0}(l,t);r>0&&n.push({id:a,data:{droppableContainer:e,value:r}})}}return n.sort(em)};function ev(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:eh}let ey=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})};function ek(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}let ew={ignoreTransform:!1};function ej(e,t){void 0===t&&(t=ew);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:a}=B(e).getComputedStyle(e);t&&(r=function(e,t,r){let a=ek(t);if(!a)return e;let{scaleX:n,scaleY:l,x:i,y:s}=a,o=e.left-i-(1-n)*parseFloat(r),d=e.top-s-(1-l)*parseFloat(r.slice(r.indexOf(" ")+1)),c=n?e.width/n:e.width,u=l?e.height/l:e.height;return{width:c,height:u,top:d,right:o+c,bottom:d+u,left:o}}(r,t,a))}let{top:a,left:n,width:l,height:i,bottom:s,right:o}=r;return{top:a,left:n,width:l,height:i,bottom:s,right:o}}function eN(e){return ej(e,{ignoreTransform:!0})}function eC(e,t){let r=[];return e?function a(n){var l,i;let s;if(null!=t&&r.length>=t||!n)return r;if(W(n)&&null!=n.scrollingElement&&!r.includes(n.scrollingElement))return r.push(n.scrollingElement),r;if(!z(n)||F(n)||r.includes(n))return r;let o=B(e).getComputedStyle(n);return(n!==e&&(void 0===(l=o)&&(l=B(n).getComputedStyle(n)),s=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=l[e];return"string"==typeof t&&s.test(t)}))&&r.push(n),void 0===(i=o)&&(i=B(n).getComputedStyle(n)),"fixed"===i.position)?r:a(n.parentNode)}(e):r}function eS(e){let[t]=eC(e,1);return null!=t?t:null}function eE(e){return O&&e?P(e)?e:$(e)?W(e)||e===U(e).scrollingElement?window:z(e)?e:null:null:null}function eM(e){return P(e)?e.scrollX:e.scrollLeft}function eD(e){return P(e)?e.scrollY:e.scrollTop}function eT(e){return{x:eM(e),y:eD(e)}}function eL(e){return!!O&&!!e&&e===document.scrollingElement}function eR(e){let t={x:0,y:0},r=eL(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},n=e.scrollTop<=t.y,l=e.scrollLeft<=t.x;return{isTop:n,isLeft:l,isBottom:e.scrollTop>=a.y,isRight:e.scrollLeft>=a.x,maxScroll:a,minScroll:t}}(a=g||(g={}))[a.Forward=1]="Forward",a[a.Backward=-1]="Backward";let eA={x:.2,y:.2};function eI(e){return e.reduce((e,t)=>Q(e,eT(t)),eh)}function eO(e,t){if(void 0===t&&(t=ej),!e)return;let{top:r,left:a,bottom:n,right:l}=t(e);eS(e)&&(n<=0||l<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}let eP=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+eM(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+eD(t),0)}]];class e${constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=eC(t),a=eI(r);for(const[t,n,l]of(this.rect={...e},this.width=e.width,this.height=e.height,eP))for(const e of n)Object.defineProperty(this,e,{get:()=>{let n=l(r),i=a[t]-n;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class eB{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var a;null==(a=this.target)||a.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function eW(e,t){let r=Math.abs(e.x),a=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t&&a>t.y}function ez(e){e.preventDefault()}function eF(e){e.stopPropagation()}(n=h||(h={})).Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange",(l=x||(x={})).Space="Space",l.Down="ArrowDown",l.Right="ArrowRight",l.Left="ArrowLeft",l.Up="ArrowUp",l.Esc="Escape",l.Enter="Enter",l.Tab="Tab";let eU={start:[x.Space,x.Enter],cancel:[x.Esc],end:[x.Space,x.Enter,x.Tab]},eH=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case x.Right:return{...r,x:r.x+25};case x.Left:return{...r,x:r.x-25};case x.Down:return{...r,y:r.y+25};case x.Up:return{...r,y:r.y-25}}};class eY{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new eB(U(t)),this.windowListeners=new eB(B(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(h.Resize,this.handleCancel),this.windowListeners.add(h.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(h.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&eO(r),t(eh)}handleKeyDown(e){if(ee(e)){let{active:t,context:r,options:a}=this.props,{keyboardCodes:n=eU,coordinateGetter:l=eH,scrollBehavior:i="smooth"}=a,{code:s}=e;if(n.end.includes(s))return void this.handleEnd(e);if(n.cancel.includes(s))return void this.handleCancel(e);let{collisionRect:o}=r.current,d=o?{x:o.left,y:o.top}:eh;this.referenceCoordinates||(this.referenceCoordinates=d);let c=l(e,{active:t,context:r.current,currentCoordinates:d});if(c){let t=Z(c,d),a={x:0,y:0},{scrollableAncestors:n}=r.current;for(let r of n){let n=e.code,{isTop:l,isRight:s,isLeft:o,isBottom:d,maxScroll:u,minScroll:g}=eR(r),h=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:a,bottom:n}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:n,width:e.clientWidth,height:e.clientHeight}}(r),m={x:Math.min(n===x.Right?h.right-h.width/2:h.right,Math.max(n===x.Right?h.left:h.left+h.width/2,c.x)),y:Math.min(n===x.Down?h.bottom-h.height/2:h.bottom,Math.max(n===x.Down?h.top:h.top+h.height/2,c.y))},f=n===x.Right&&!s||n===x.Left&&!o,p=n===x.Down&&!d||n===x.Up&&!l;if(f&&m.x!==c.x){let e=r.scrollLeft+t.x,l=n===x.Right&&e<=u.x||n===x.Left&&e>=g.x;if(l&&!t.y)return void r.scrollTo({left:e,behavior:i});l?a.x=r.scrollLeft-e:a.x=n===x.Right?r.scrollLeft-u.x:r.scrollLeft-g.x,a.x&&r.scrollBy({left:-a.x,behavior:i});break}if(p&&m.y!==c.y){let e=r.scrollTop+t.y,l=n===x.Down&&e<=u.y||n===x.Up&&e>=g.y;if(l&&!t.x)return void r.scrollTo({top:e,behavior:i});l?a.y=r.scrollTop-e:a.y=n===x.Down?r.scrollTop-u.y:r.scrollTop-g.y,a.y&&r.scrollBy({top:-a.y,behavior:i});break}}this.handleMove(e,Q(Z(c,this.referenceCoordinates),a))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function eX(e){return!!(e&&"distance"in e)}function eK(e){return!!(e&&"delay"in e)}eY.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=eU,onActivation:n}=t,{active:l}=r,{code:i}=e.nativeEvent;if(a.start.includes(i)){let t=l.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==n||n({event:e.nativeEvent}),!0)}return!1}}];class eV{constructor(e,t,r){var a;void 0===r&&(r=function(e){let{EventTarget:t}=B(e);return e instanceof t?e:U(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:n}=e,{target:l}=n;this.props=e,this.events=t,this.document=U(l),this.documentListeners=new eB(this.document),this.listeners=new eB(r),this.windowListeners=new eB(B(l)),this.initialCoordinates=null!=(a=et(n))?a:eh,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(h.Resize,this.handleCancel),this.windowListeners.add(h.DragStart,ez),this.windowListeners.add(h.VisibilityChange,this.handleCancel),this.windowListeners.add(h.ContextMenu,ez),this.documentListeners.add(h.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(eK(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(eX(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:a}=this.props;a(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(h.Click,eF,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(h.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:a,props:n}=this,{onMove:l,options:{activationConstraint:i}}=n;if(!a)return;let s=null!=(t=et(e))?t:eh,o=Z(a,s);if(!r&&i){if(eX(i)){if(null!=i.tolerance&&eW(o,i.tolerance))return this.handleCancel();if(eW(o,i.distance))return this.handleStart()}return eK(i)&&eW(o,i.tolerance)?this.handleCancel():void this.handlePending(i,o)}e.cancelable&&e.preventDefault(),l(s)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===x.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let eJ={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class e_ extends eV{constructor(e){const{event:t}=e;super(e,eJ,U(t.target))}}e_.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!!r.isPrimary&&0===r.button&&(null==a||a({event:r}),!0)}}];(i=m||(m={}))[i.RightClick=2]="RightClick";let eq={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class eG extends eV{constructor(e){super(e,eq)}static setup(){return window.addEventListener(eq.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(eq.move.name,e)};function e(){}}}eG.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t,{touches:n}=r;return!(n.length>1)&&(null==a||a({event:r}),!0)}}],(s=f||(f={}))[s.Pointer=0]="Pointer",s[s.DraggableRect=1]="DraggableRect",(o=p||(p={}))[o.TreeOrder=0]="TreeOrder",o[o.ReversedTreeOrder=1]="ReversedTreeOrder";let eQ={x:{[g.Backward]:!1,[g.Forward]:!1},y:{[g.Backward]:!1,[g.Forward]:!1}};(d=b||(b={}))[d.Always=0]="Always",d[d.BeforeDragging=1]="BeforeDragging",d[d.WhileDragging=2]="WhileDragging",(v||(v={})).Optimized="optimized";let eZ=new Map;function e0(e,t){return K(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function e1(e){let{callback:t,disabled:r}=e,a=Y(t),n=(0,w.useMemo)(()=>{if(r||"u"<typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(a)},[r]);return(0,w.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]),n}function e2(e){return new e$(ej(e),e)}function e5(e,t,r){void 0===t&&(t=e2);let[a,n]=(0,w.useState)(null);function l(){n(a=>{if(!e)return null;if(!1===e.isConnected){var n;return null!=(n=null!=a?a:r)?n:null}let l=t(e);return JSON.stringify(a)===JSON.stringify(l)?a:l})}let i=function(e){let{callback:t,disabled:r}=e,a=Y(t),n=(0,w.useMemo)(()=>{if(r||"u"<typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(a)},[a,r]);return(0,w.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]),n}({callback(t){if(e)for(let r of t){let{type:t,target:a}=r;if("childList"===t&&a instanceof HTMLElement&&a.contains(e)){l();break}}}}),s=e1({callback:l});return H(()=>{l(),e?(null==s||s.observe(e),null==i||i.observe(document.body,{childList:!0,subtree:!0})):(null==s||s.disconnect(),null==i||i.disconnect())},[e]),a}let e4=[];function e3(e,t){void 0===t&&(t=[]);let r=(0,w.useRef)(null);return(0,w.useEffect)(()=>{r.current=null},t),(0,w.useEffect)(()=>{let t=e!==eh;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?Z(e,r.current):eh}function e7(e){return(0,w.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let e6=[];function e8(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return z(t)?t:e}let e9=[{sensor:e_,options:{}},{sensor:eY,options:{}}],te={current:{}},tt={draggable:{measure:eN},droppable:{measure:eN,strategy:b.WhileDragging,frequency:v.Optimized},dragOverlay:{measure:ej}};class tr extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let ta={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new tr,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:eu},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:tt,measureDroppableContainers:eu,windowRect:null,measuringScheduled:!1},tn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:eu,draggableNodes:new Map,over:null,measureDroppableContainers:eu},tl=(0,w.createContext)(tn),ti=(0,w.createContext)(ta);function ts(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new tr}}}function to(e,t){switch(t.type){case u.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case u.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case u.DragEnd:case u.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case u.RegisterDroppable:{let{element:r}=t,{id:a}=r,n=new tr(e.droppable.containers);return n.set(a,r),{...e,droppable:{...e.droppable,containers:n}}}case u.SetDroppableDisabled:{let{id:r,key:a,disabled:n}=t,l=e.droppable.containers.get(r);if(!l||a!==l.key)return e;let i=new tr(e.droppable.containers);return i.set(r,{...l,disabled:n}),{...e,droppable:{...e.droppable,containers:i}}}case u.UnregisterDroppable:{let{id:r,key:a}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;let l=new tr(e.droppable.containers);return l.delete(r),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function td(e){let{disabled:t}=e,{active:r,activatorEvent:a,draggableNodes:n}=(0,w.useContext)(tl),l=J(a),i=J(null==r?void 0:r.id);return(0,w.useEffect)(()=>{if(!t&&!a&&l&&null!=i){if(!ee(l)||document.activeElement===l.target)return;let e=n.get(i);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=e.matches(ea)?e:e.querySelector(ea);if(t){t.focus();break}}})}},[a,t,n,i,l]),null}function tc(e,t){let{transform:r,...a}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...a}),r):r}let tu=(0,w.createContext)({...eh,scaleX:1,scaleY:1});(c=y||(y={}))[c.Uninitialized=0]="Uninitialized",c[c.Initializing=1]="Initializing",c[c.Initialized=2]="Initialized";let tg=(0,w.memo)(function(e){var t,r,a,n,l,i,s,o;let d,c,h,x,m,v,k,j,{id:N,accessibility:C,autoScroll:S=!0,children:E,sensors:M=e9,collisionDetection:D=eb,measuring:T,modifiers:L,...R}=e,[A,P]=(0,w.useReducer)(to,void 0,ts),[$,W]=function(){let[e]=(0,w.useState)(()=>new Set),t=(0,w.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,w.useCallback)(t=>{let{type:r,event:a}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,a)})},[e]),t]}(),[F,U]=(0,w.useState)(y.Uninitialized),Y=F===y.Initialized,{draggable:{active:_,nodes:G,translate:Z},droppable:{containers:ee}}=A,er=null!=_?G.get(_):null,ea=(0,w.useRef)({initial:null,translated:null}),en=(0,w.useMemo)(()=>{var e;return null!=_?{id:_,data:null!=(e=null==er?void 0:er.data)?e:te,rect:ea}:null},[_,er]),el=(0,w.useRef)(null),[ei,eo]=(0,w.useState)(null),[ed,eu]=(0,w.useState)(null),eg=X(R,Object.values(R)),ex=q("DndDescribedBy",N),em=(0,w.useMemo)(()=>ee.getEnabled(),[ee]),ef=(0,w.useMemo)(()=>({draggable:{...tt.draggable,...null==T?void 0:T.draggable},droppable:{...tt.droppable,...null==T?void 0:T.droppable},dragOverlay:{...tt.dragOverlay,...null==T?void 0:T.dragOverlay}}),[null==T?void 0:T.draggable,null==T?void 0:T.droppable,null==T?void 0:T.dragOverlay]),{droppableRects:ep,measureDroppableContainers:ek,measuringScheduled:ew}=function(e,t){let{dragging:r,dependencies:a,config:n}=t,[l,i]=(0,w.useState)(null),{frequency:s,measure:o,strategy:d}=n,c=(0,w.useRef)(e),u=function(){switch(d){case b.Always:return!1;case b.BeforeDragging:return r;default:return!r}}(),g=X(u),h=(0,w.useCallback)(function(e){void 0===e&&(e=[]),g.current||i(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[g]),x=(0,w.useRef)(null),m=K(t=>{if(u&&!r)return eZ;if(!t||t===eZ||c.current!==e||null!=l){let t=new Map;for(let r of e){if(!r)continue;if(l&&l.length>0&&!l.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,a=e?new e$(o(e),e):null;r.rect.current=a,a&&t.set(r.id,a)}return t}return t},[e,l,r,u,o]);return(0,w.useEffect)(()=>{c.current=e},[e]),(0,w.useEffect)(()=>{u||h()},[r,u]),(0,w.useEffect)(()=>{l&&l.length>0&&i(null)},[JSON.stringify(l)]),(0,w.useEffect)(()=>{u||"number"!=typeof s||null!==x.current||(x.current=setTimeout(()=>{h(),x.current=null},s))},[s,u,h,...a]),{droppableRects:m,measureDroppableContainers:h,measuringScheduled:null!=l}}(em,{dragging:Y,dependencies:[Z.x,Z.y],config:ef.droppable}),eN=K(e=>{var t;return null==_?null:null!=(t=null!=m?m:e)?t:null},[m=(x=null!=_?G.get(_):void 0)?x.node.current:null,_]),eM=(0,w.useMemo)(()=>ed?et(ed):null,[ed]),eD=(d=(null==ei?void 0:ei.autoScrollEnabled)===!1,c="object"==typeof S?!1===S.enabled:!1===S,h=Y&&!d&&!c,"object"==typeof S?{...S,enabled:h}:{enabled:h}),eO=e0(eN,ef.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:a,config:n=!0}=e,l=(0,w.useRef)(!1),{x:i,y:s}="boolean"==typeof n?{x:n,y:n}:n;H(()=>{if(!i&&!s||!t){l.current=!1;return}if(l.current||!a)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let n=ev(r(e),a);if(i||(n.x=0),s||(n.y=0),l.current=!0,Math.abs(n.x)>0||Math.abs(n.y)>0){let t=eS(e);t&&t.scrollBy({top:n.y,left:n.x})}},[t,i,s,a,r])}({activeNode:null!=_?G.get(_):null,config:eD.layoutShiftCompensation,initialRect:eO,measure:ef.draggable.measure});let eP=e5(eN,ef.draggable.measure,eO),eB=e5(eN?eN.parentElement:null),eW=(0,w.useRef)({activatorEvent:null,active:null,activeNode:eN,collisionRect:null,collisions:null,droppableRects:ep,draggableNodes:G,draggingNode:null,draggingNodeRect:null,droppableContainers:ee,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ez=ee.getNodeFor(null==(t=eW.current.over)?void 0:t.id),eF=function(e){let{measure:t}=e,[r,a]=(0,w.useState)(null),n=e1({callback:(0,w.useCallback)(e=>{for(let{target:r}of e)if(z(r)){a(e=>{let a=t(r);return e?{...e,width:a.width,height:a.height}:a});break}},[t])}),[l,i]=V((0,w.useCallback)(e=>{let r=e8(e);null==n||n.disconnect(),r&&(null==n||n.observe(r)),a(r?t(r):null)},[t,n]));return(0,w.useMemo)(()=>({nodeRef:l,rect:r,setRef:i}),[r,l,i])}({measure:ef.dragOverlay.measure}),eU=null!=(r=eF.nodeRef.current)?r:eN,eH=Y?null!=(a=eF.rect)?a:eP:null,eY=!!(eF.nodeRef.current&&eF.rect),eX=(v=e0(l=eY?null:eP),ev(l,v)),eK=e7(eU?B(eU):null),eV=(i=Y?null!=ez?ez:eN:null,k=(0,w.useRef)(i),j=K(e=>i?e&&e!==e4&&i&&k.current&&i.parentNode===k.current.parentNode?e:eC(i):e4,[i]),(0,w.useEffect)(()=>{k.current=i},[i]),j),eJ=function(e,t){void 0===t&&(t=ej);let[r]=e,a=e7(r?B(r):null),[n,l]=(0,w.useState)(e6);function i(){l(()=>e.length?e.map(e=>eL(e)?a:new e$(t(e),e)):e6)}let s=e1({callback:i});return H(()=>{null==s||s.disconnect(),i(),e.forEach(e=>null==s?void 0:s.observe(e))},[e]),n}(eV),e_=tc(L,{transform:{x:Z.x-eX.x,y:Z.y-eX.y,scaleX:1,scaleY:1},activatorEvent:ed,active:en,activeNodeRect:eP,containerNodeRect:eB,draggingNodeRect:eH,over:eW.current.over,overlayNodeRect:eF.rect,scrollableAncestors:eV,scrollableAncestorRects:eJ,windowRect:eK}),eq=eM?Q(eM,Z):null,eG=function(e){let[t,r]=(0,w.useState)(null),a=(0,w.useRef)(e),n=(0,w.useCallback)(e=>{let t=eE(e.target);t&&r(e=>e?(e.set(t,eT(t)),new Map(e)):null)},[]);return(0,w.useEffect)(()=>{let t=a.current;if(e!==t){l(t);let i=e.map(e=>{let t=eE(e);return t?(t.addEventListener("scroll",n,{passive:!0}),[t,eT(t)]):null}).filter(e=>null!=e);r(i.length?new Map(i):null),a.current=e}return()=>{l(e),l(t)};function l(e){e.forEach(e=>{let t=eE(e);null==t||t.removeEventListener("scroll",n)})}},[n,e]),(0,w.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>Q(e,t),eh):eI(e):eh,[e,t])}(eV),e2=e3(eG),tr=e3(eG,[eP]),ta=Q(e_,e2),tn=eH?ey(eH,e_):null,tg=en&&tn?D({active:en,collisionRect:tn,droppableRects:ep,droppableContainers:em,pointerCoordinates:eq}):null,th=function(e,t){if(!e||0===e.length)return null;let[r]=e;return r.id}(tg,0),[tx,tm]=(0,w.useState)(null),tf=(s=eY?e_:Q(e_,tr),o=null!=(n=null==tx?void 0:tx.rect)?n:null,{...s,scaleX:o&&eP?o.width/eP.width:1,scaleY:o&&eP?o.height/eP.height:1}),tp=(0,w.useRef)(null),tb=(0,w.useCallback)((e,t)=>{let{sensor:r,options:a}=t;if(null==el.current)return;let n=G.get(el.current);if(!n)return;let l=e.nativeEvent,i=new r({active:el.current,activeNode:n,event:l,options:a,context:eW,onAbort(e){if(!G.get(e))return;let{onDragAbort:t}=eg.current,r={id:e};null==t||t(r),$({type:"onDragAbort",event:r})},onPending(e,t,r,a){if(!G.get(e))return;let{onDragPending:n}=eg.current,l={id:e,constraint:t,initialCoordinates:r,offset:a};null==n||n(l),$({type:"onDragPending",event:l})},onStart(e){let t=el.current;if(null==t)return;let r=G.get(t);if(!r)return;let{onDragStart:a}=eg.current,n={activatorEvent:l,active:{id:t,data:r.data,rect:ea}};(0,I.unstable_batchedUpdates)(()=>{null==a||a(n),U(y.Initializing),P({type:u.DragStart,initialCoordinates:e,active:t}),$({type:"onDragStart",event:n}),eo(tp.current),eu(l)})},onMove(e){P({type:u.DragMove,coordinates:e})},onEnd:s(u.DragEnd),onCancel:s(u.DragCancel)});function s(e){return async function(){let{active:t,collisions:r,over:a,scrollAdjustedTranslate:n}=eW.current,i=null;if(t&&n){let{cancelDrop:s}=eg.current;i={activatorEvent:l,active:t,collisions:r,delta:n,over:a},e===u.DragEnd&&"function"==typeof s&&await Promise.resolve(s(i))&&(e=u.DragCancel)}el.current=null,(0,I.unstable_batchedUpdates)(()=>{P({type:e}),U(y.Uninitialized),tm(null),eo(null),eu(null),tp.current=null;let t=e===u.DragEnd?"onDragEnd":"onDragCancel";if(i){let e=eg.current[t];null==e||e(i),$({type:t,event:i})}})}}tp.current=i},[G]),tv=(0,w.useCallback)((e,t)=>(r,a)=>{let n=r.nativeEvent,l=G.get(a);null!==el.current||!l||n.dndKit||n.defaultPrevented||!0===e(r,t.options,{active:l})&&(n.dndKit={capturedBy:t.sensor},el.current=a,tb(r,t))},[G,tb]),ty=(0,w.useMemo)(()=>M.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:tv(e.handler,t)}))]},[]),[M,tv]);(0,w.useEffect)(()=>{if(!O)return;let e=M.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},M.map(e=>{let{sensor:t}=e;return t})),H(()=>{eP&&F===y.Initializing&&U(y.Initialized)},[eP,F]),(0,w.useEffect)(()=>{let{onDragMove:e}=eg.current,{active:t,activatorEvent:r,collisions:a,over:n}=eW.current;if(!t||!r)return;let l={active:t,activatorEvent:r,collisions:a,delta:{x:ta.x,y:ta.y},over:n};(0,I.unstable_batchedUpdates)(()=>{null==e||e(l),$({type:"onDragMove",event:l})})},[ta.x,ta.y]),(0,w.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:a,scrollAdjustedTranslate:n}=eW.current;if(!e||null==el.current||!t||!n)return;let{onDragOver:l}=eg.current,i=a.get(th),s=i&&i.rect.current?{id:i.id,rect:i.rect.current,data:i.data,disabled:i.disabled}:null,o={active:e,activatorEvent:t,collisions:r,delta:{x:n.x,y:n.y},over:s};(0,I.unstable_batchedUpdates)(()=>{tm(s),null==l||l(o),$({type:"onDragOver",event:o})})},[th]),H(()=>{eW.current={activatorEvent:ed,active:en,activeNode:eN,collisionRect:tn,collisions:tg,droppableRects:ep,draggableNodes:G,draggingNode:eU,draggingNodeRect:eH,droppableContainers:ee,over:tx,scrollableAncestors:eV,scrollAdjustedTranslate:ta},ea.current={initial:eH,translated:tn}},[en,eN,tg,tn,G,eU,eH,ep,ee,tx,eV,ta]),function(e){let t,{acceleration:r,activator:a=f.Pointer,canScroll:n,draggingRect:l,enabled:i,interval:s=5,order:o=p.TreeOrder,pointerCoordinates:d,scrollableAncestors:c,scrollableAncestorRects:u,delta:h,threshold:x}=e,m=function(e){let{delta:t,disabled:r}=e,a=J(t);return K(e=>{if(r||!a||!e)return eQ;let n={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[g.Backward]:e.x[g.Backward]||-1===n.x,[g.Forward]:e.x[g.Forward]||1===n.x},y:{[g.Backward]:e.y[g.Backward]||-1===n.y,[g.Forward]:e.y[g.Forward]||1===n.y}}},[r,t,a])}({delta:h,disabled:!i}),[b,v]=(t=(0,w.useRef)(null),[(0,w.useCallback)((e,r)=>{t.current=setInterval(e,r)},[]),(0,w.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]),y=(0,w.useRef)({x:0,y:0}),k=(0,w.useRef)({x:0,y:0}),j=(0,w.useMemo)(()=>{switch(a){case f.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case f.DraggableRect:return l}},[a,l,d]),N=(0,w.useRef)(null),C=(0,w.useCallback)(()=>{let e=N.current;if(!e)return;let t=y.current.x*k.current.x,r=y.current.y*k.current.y;e.scrollBy(t,r)},[]),S=(0,w.useMemo)(()=>o===p.TreeOrder?[...c].reverse():c,[o,c]);(0,w.useEffect)(()=>{if(!i||!c.length||!j)return void v();for(let e of S){if((null==n?void 0:n(e))===!1)continue;let t=u[c.indexOf(e)];if(!t)continue;let{direction:a,speed:l}=function(e,t,r,a,n){let{top:l,left:i,right:s,bottom:o}=r;void 0===a&&(a=10),void 0===n&&(n=eA);let{isTop:d,isBottom:c,isLeft:u,isRight:h}=eR(e),x={x:0,y:0},m={x:0,y:0},f={height:t.height*n.y,width:t.width*n.x};return!d&&l<=t.top+f.height?(x.y=g.Backward,m.y=a*Math.abs((t.top+f.height-l)/f.height)):!c&&o>=t.bottom-f.height&&(x.y=g.Forward,m.y=a*Math.abs((t.bottom-f.height-o)/f.height)),!h&&s>=t.right-f.width?(x.x=g.Forward,m.x=a*Math.abs((t.right-f.width-s)/f.width)):!u&&i<=t.left+f.width&&(x.x=g.Backward,m.x=a*Math.abs((t.left+f.width-i)/f.width)),{direction:x,speed:m}}(e,t,j,r,x);for(let e of["x","y"])m[e][a[e]]||(l[e]=0,a[e]=0);if(l.x>0||l.y>0){v(),N.current=e,b(C,s),y.current=l,k.current=a;return}}y.current={x:0,y:0},k.current={x:0,y:0},v()},[r,C,n,v,i,s,JSON.stringify(j),JSON.stringify(m),b,c,S,u,JSON.stringify(x)])}({...eD,delta:Z,draggingRect:tn,pointerCoordinates:eq,scrollableAncestors:eV,scrollableAncestorRects:eJ});let tk=(0,w.useMemo)(()=>({active:en,activeNode:eN,activeNodeRect:eP,activatorEvent:ed,collisions:tg,containerNodeRect:eB,dragOverlay:eF,draggableNodes:G,droppableContainers:ee,droppableRects:ep,over:tx,measureDroppableContainers:ek,scrollableAncestors:eV,scrollableAncestorRects:eJ,measuringConfiguration:ef,measuringScheduled:ew,windowRect:eK}),[en,eN,eP,ed,tg,eB,eF,G,ee,ep,tx,ek,eV,eJ,ef,ew,eK]),tw=(0,w.useMemo)(()=>({activatorEvent:ed,activators:ty,active:en,activeNodeRect:eP,ariaDescribedById:{draggable:ex},dispatch:P,draggableNodes:G,over:tx,measureDroppableContainers:ek}),[ed,ty,en,eP,P,ex,G,tx,ek]);return w.default.createElement(es.Provider,{value:W},w.default.createElement(tl.Provider,{value:tw},w.default.createElement(ti.Provider,{value:tk},w.default.createElement(tu.Provider,{value:tf},E)),w.default.createElement(td,{disabled:(null==C?void 0:C.restoreFocus)===!1})),w.default.createElement(ec,{...C,hiddenTextDescribedById:ex}))}),th=(0,w.createContext)(null),tx="button",tm={timeout:25};function tf(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:n}=e,l=q("Droppable"),{active:i,dispatch:s,over:o,measureDroppableContainers:d}=(0,w.useContext)(tl),c=(0,w.useRef)({disabled:r}),g=(0,w.useRef)(!1),h=(0,w.useRef)(null),x=(0,w.useRef)(null),{disabled:m,updateMeasurementsFor:f,timeout:p}={...tm,...n},b=X(null!=f?f:a),v=e1({callback:(0,w.useCallback)(()=>{if(!g.current){g.current=!0;return}null!=x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),x.current=null},p)},[p]),disabled:m||!i}),[y,k]=V((0,w.useCallback)((e,t)=>{v&&(t&&(v.unobserve(t),g.current=!1),e&&v.observe(e))},[v])),j=X(t);return(0,w.useEffect)(()=>{v&&y.current&&(v.disconnect(),g.current=!1,v.observe(y.current))},[y,v]),(0,w.useEffect)(()=>(s({type:u.RegisterDroppable,element:{id:a,key:l,disabled:r,node:y,rect:h,data:j}}),()=>s({type:u.UnregisterDroppable,key:l,id:a})),[a]),(0,w.useEffect)(()=>{r!==c.current.disabled&&(s({type:u.SetDroppableDisabled,id:a,key:l,disabled:r}),c.current.disabled=r)},[a,l,r,s]),{active:i,rect:h,isOver:(null==o?void 0:o.id)===a,node:y,over:o,setNodeRef:k}}function tp(e){let{animation:t,children:r}=e,[a,n]=(0,w.useState)(null),[l,i]=(0,w.useState)(null),s=J(r);return r||a||!s||n(s),H(()=>{if(!l)return;let e=null==a?void 0:a.key,r=null==a?void 0:a.props.id;null==e||null==r?n(null):Promise.resolve(t(r,l)).then(()=>{n(null)})},[t,a,l]),w.default.createElement(w.default.Fragment,null,r,a?(0,w.cloneElement)(a,{ref:i}):null)}let tb={x:0,y:0,scaleX:1,scaleY:1};function tv(e){let{children:t}=e;return w.default.createElement(tl.Provider,{value:tn},w.default.createElement(tu.Provider,{value:tb},t))}let ty={position:"fixed",touchAction:"none"},tk=e=>ee(e)?"transform 250ms ease":void 0,tw=(0,w.forwardRef)((e,t)=>{let{as:r,activatorEvent:a,adjustScale:n,children:l,className:i,rect:s,style:o,transform:d,transition:c=tk}=e;if(!s)return null;let u=n?d:{...d,scaleX:1,scaleY:1},g={...ty,width:s.width,height:s.height,top:s.top,left:s.left,transform:er.Transform.toString(u),transformOrigin:n&&a?function(e,t){let r=et(e);if(!r)return"0 0";let a={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return a.x+"% "+a.y+"%"}(a,s):void 0,transition:"function"==typeof c?c(a):c,...o};return w.default.createElement(r,{className:i,style:g,ref:t},l)}),tj={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:er.Transform.toString(t)},{transform:er.Transform.toString(r)}]},sideEffects:(t={styles:{active:{opacity:"0"}}},e=>{let{active:r,dragOverlay:a}=e,n={},{styles:l,className:i}=t;if(null!=l&&l.active)for(let[e,t]of Object.entries(l.active))void 0!==t&&(n[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=l&&l.dragOverlay)for(let[e,t]of Object.entries(l.dragOverlay))void 0!==t&&a.node.style.setProperty(e,t);return null!=i&&i.active&&r.node.classList.add(i.active),null!=i&&i.dragOverlay&&a.node.classList.add(i.dragOverlay),function(){for(let[e,t]of Object.entries(n))r.node.style.setProperty(e,t);null!=i&&i.active&&r.node.classList.remove(i.active)}})},tN=0,tC=w.default.memo(e=>{var t;let{adjustScale:r=!1,children:a,dropAnimation:n,style:l,transition:i,modifiers:s,wrapperElement:o="div",className:d,zIndex:c=999}=e,{activatorEvent:u,active:g,activeNodeRect:h,containerNodeRect:x,draggableNodes:m,droppableContainers:f,dragOverlay:p,over:b,measuringConfiguration:v,scrollableAncestors:y,scrollableAncestorRects:k,windowRect:j}=(0,w.useContext)(ti),N=(0,w.useContext)(tu),C=(t=null==g?void 0:g.id,(0,w.useMemo)(()=>{if(null!=t)return++tN},[t])),S=tc(s,{activatorEvent:u,active:g,activeNodeRect:h,containerNodeRect:x,draggingNodeRect:p.rect,over:b,overlayNodeRect:p.rect,scrollableAncestors:y,scrollableAncestorRects:k,transform:N,windowRect:j}),E=e0(h),M=function(e){let{config:t,draggableNodes:r,droppableContainers:a,measuringConfiguration:n}=e;return Y((e,l)=>{if(null===t)return;let i=r.get(e);if(!i)return;let s=i.node.current;if(!s)return;let o=e8(l);if(!o)return;let{transform:d}=B(l).getComputedStyle(l),c=ek(d);if(!c)return;let u="function"==typeof t?t:function(e){let{duration:t,easing:r,sideEffects:a,keyframes:n}={...tj,...e};return e=>{let{active:l,dragOverlay:i,transform:s,...o}=e;if(!t)return;let d={x:i.rect.left-l.rect.left,y:i.rect.top-l.rect.top},c={scaleX:1!==s.scaleX?l.rect.width*s.scaleX/i.rect.width:1,scaleY:1!==s.scaleY?l.rect.height*s.scaleY/i.rect.height:1},u={x:s.x-d.x,y:s.y-d.y,...c},g=n({...o,active:l,dragOverlay:i,transform:{initial:s,final:u}}),[h]=g,x=g[g.length-1];if(JSON.stringify(h)===JSON.stringify(x))return;let m=null==a?void 0:a({active:l,dragOverlay:i,...o}),f=i.node.animate(g,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{f.onfinish=()=>{null==m||m(),e()}})}}(t);return eO(s,n.draggable.measure),u({active:{id:e,data:i.data,node:s,rect:n.draggable.measure(s)},draggableNodes:r,dragOverlay:{node:l,rect:n.dragOverlay.measure(o)},droppableContainers:a,measuringConfiguration:n,transform:c})})}({config:n,draggableNodes:m,droppableContainers:f,measuringConfiguration:v}),D=E?p.setRef:void 0;return w.default.createElement(tv,null,w.default.createElement(tp,{animation:M},g&&C?w.default.createElement(tw,{key:C,id:g.id,ref:D,as:o,activatorEvent:u,adjustScale:r,className:d,transition:i,rect:E,style:{zIndex:c,...l},transform:S},a):null))});function tS(e,t,r){let a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function tE(e){return null!==e&&e>=0}let tM=w.default.createContext({activeIndex:-1,containerId:"Sortable",disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:e=>{let{rects:t,activeIndex:r,overIndex:a,index:n}=e,l=tS(t,a,r),i=t[n],s=l[n];return s&&i?{x:s.left-i.left,y:s.top-i.top,scaleX:s.width/i.width,scaleY:s.height/i.height}:null},disabled:{draggable:!1,droppable:!1}}),tD=e=>{let{id:t,items:r,activeIndex:a,overIndex:n}=e;return tS(r,a,n).indexOf(t)},tT=e=>{let{containerId:t,isSorting:r,wasDragging:a,index:n,items:l,newIndex:i,previousItems:s,previousContainerId:o,transition:d}=e;return!!d&&!!a&&(s===l||n!==i)&&(!!r||i!==n&&t===o)},tL={duration:200,easing:"ease"},tR="transform",tA=er.Transition.toString({property:tR,duration:0,easing:"linear"}),tI={roleDescription:"sortable"};function tO(e){var t,r,a,n;let{animateLayoutChanges:l=tT,attributes:i,disabled:s,data:o,getNewIndex:d=tD,id:c,strategy:u,resizeObserverConfig:g,transition:h=tL}=e,{items:x,containerId:m,activeIndex:f,disabled:p,disableTransforms:b,sortedRects:v,overIndex:y,useDragOverlay:k,strategy:j}=(0,w.useContext)(tM),N=(t=s,r=p,"boolean"==typeof t?{draggable:t,droppable:!1}:{draggable:null!=(a=null==t?void 0:t.draggable)?a:r.draggable,droppable:null!=(n=null==t?void 0:t.droppable)?n:r.droppable}),C=x.indexOf(c),S=(0,w.useMemo)(()=>({sortable:{containerId:m,index:C,items:x},...o}),[m,o,C,x]),E=(0,w.useMemo)(()=>x.slice(x.indexOf(c)),[x,c]),{rect:M,node:D,isOver:T,setNodeRef:L}=tf({id:c,data:S,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...g}}),{active:R,activatorEvent:A,activeNodeRect:I,attributes:O,setNodeRef:P,listeners:$,isDragging:B,over:W,setActivatorNodeRef:z,transform:F}=function(e){let{id:t,data:r,disabled:a=!1,attributes:n}=e,l=q("Draggable"),{activators:i,activatorEvent:s,active:o,activeNodeRect:d,ariaDescribedById:c,draggableNodes:u,over:g}=(0,w.useContext)(tl),{role:h=tx,roleDescription:x="draggable",tabIndex:m=0}=null!=n?n:{},f=(null==o?void 0:o.id)===t,p=(0,w.useContext)(f?tu:th),[b,v]=V(),[y,k]=V(),j=(0,w.useMemo)(()=>i.reduce((e,r)=>{let{eventName:a,handler:n}=r;return e[a]=e=>{n(e,t)},e},{}),[i,t]),N=X(r);return H(()=>(u.set(t,{id:t,key:l,node:b,activatorNode:y,data:N}),()=>{let e=u.get(t);e&&e.key===l&&u.delete(t)}),[u,t]),{active:o,activatorEvent:s,activeNodeRect:d,attributes:(0,w.useMemo)(()=>({role:h,tabIndex:m,"aria-disabled":a,"aria-pressed":!!f&&h===tx||void 0,"aria-roledescription":x,"aria-describedby":c.draggable}),[a,h,m,f,x,c.draggable]),isDragging:f,listeners:a?void 0:j,node:b,over:g,setNodeRef:v,setActivatorNodeRef:k,transform:p}}({id:c,data:S,attributes:{...tI,...i},disabled:N.draggable}),U=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,w.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(L,P),Y=!!R,K=Y&&!b&&tE(f)&&tE(y),J=!k&&B,_=J&&K?F:null,G=K?null!=_?_:(null!=u?u:j)({rects:v,activeNodeRect:I,activeIndex:f,overIndex:y,index:C}):null,Q=tE(f)&&tE(y)?d({id:c,items:x,activeIndex:f,overIndex:y}):C,Z=null==R?void 0:R.id,et=(0,w.useRef)({activeId:Z,items:x,newIndex:Q,containerId:m}),ea=x!==et.current.items,en=l({active:R,containerId:m,isDragging:B,isSorting:Y,id:c,index:C,items:x,newIndex:et.current.newIndex,previousItems:et.current.items,previousContainerId:et.current.containerId,transition:h,wasDragging:null!=et.current.activeId}),el=function(e){let{disabled:t,index:r,node:a,rect:n}=e,[l,i]=(0,w.useState)(null),s=(0,w.useRef)(r);return H(()=>{if(!t&&r!==s.current&&a.current){let e=n.current;if(e){let t=ej(a.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&i(r)}}r!==s.current&&(s.current=r)},[t,r,a,n]),(0,w.useEffect)(()=>{l&&i(null)},[l]),l}({disabled:!en,index:C,node:D,rect:M});return(0,w.useEffect)(()=>{Y&&et.current.newIndex!==Q&&(et.current.newIndex=Q),m!==et.current.containerId&&(et.current.containerId=m),x!==et.current.items&&(et.current.items=x)},[Y,Q,m,x]),(0,w.useEffect)(()=>{if(Z===et.current.activeId)return;if(null!=Z&&null==et.current.activeId){et.current.activeId=Z;return}let e=setTimeout(()=>{et.current.activeId=Z},50);return()=>clearTimeout(e)},[Z]),{active:R,activeIndex:f,attributes:O,data:S,rect:M,index:C,newIndex:Q,items:x,isOver:T,isSorting:Y,isDragging:B,listeners:$,node:D,overIndex:y,over:W,setNodeRef:U,setActivatorNodeRef:z,setDroppableNodeRef:L,setDraggableNodeRef:P,transform:null!=el?el:G,transition:el||ea&&et.current.newIndex===C?tA:(!J||ee(A))&&h&&(Y||en)?er.Transition.toString({...h,property:tR}):void 0}}x.Down,x.Right,x.Up,x.Left;let tP=[{id:"suggested",title:"Suggested",dotColor:"bg-purple-400"},{id:"backlog",title:"Backlog",dotColor:"bg-gray-400"},{id:"in-progress",title:"In Progress",dotColor:"bg-blue-400"},{id:"review",title:"Review",dotColor:"bg-amber-400"},{id:"done",title:"Done",dotColor:"bg-emerald-400"},{id:"archived",title:"Archived",dotColor:"bg-red-400"}],t$={suggested:"#a855f7",backlog:"#9ca3af","in-progress":"#60a5fa",review:"#f59e0b",done:"#34d399",archived:"#f87171"},tB=(0,w.forwardRef)(function({task:e,subTasks:t=[],isSubTask:r,onEdit:a,onArchive:n,onDelete:l,onRestore:i,onAddSubTask:s,animateIn:o,onToggleExpand:d,expanded:c,isDragOverlay:u,isDropTarget:g,dragHandleProps:h,style:x,className:m,...f},p){let[b,v]=(0,w.useState)(!1),[y,j]=(0,w.useState)(!o);(0,w.useEffect)(()=>{o&&(j(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{j(!0)})}))},[o]);let N="archived"===e.column,C="done"===e.column,S=t$[e.column]||"#9ca3af",M=t.filter(e=>"done"===e.column).length,D=t.length;return(0,k.jsxs)("div",{ref:p,style:{...x,borderLeftColor:S,borderLeftWidth:4,...o?{opacity:y?1:.3,transition:`opacity 1.2s ease-out${x?.transition?", "+x.transition:""}`}:{}},className:`group rounded-xl p-4 transition-all duration-200 border ${r?"ml-4 bg-gray-50 dark:bg-gray-900/40 border-gray-200 dark:border-gray-800/30":"bg-white dark:bg-gray-900/60"} ${N?"border-red-300 dark:border-red-500/20 opacity-50":C?"border-emerald-300 dark:border-emerald-500/20 opacity-70":"border-gray-200 dark:border-gray-800/50 hover:border-amber-400 dark:hover:border-amber-500/30 hover:shadow-lg dark:hover:shadow-[0_0_20px_rgba(245,158,11,0.08)]"} ${u?"shadow-2xl ring-2 ring-amber-400 scale-[1.02] rotate-1":""} ${g?"ring-2 ring-blue-400 bg-blue-50 dark:bg-blue-900/20":""} ${m||""}`,...f,children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[!N&&!r&&(0,k.jsx)("div",{className:"opacity-40 group-hover:opacity-60 transition-opacity flex-shrink-0 cursor-grab active:cursor-grabbing p-1 -m-1 select-none",style:{touchAction:"none"},...h||{},children:(0,k.jsxs)("svg",{className:"w-4 h-4 text-gray-400 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:[(0,k.jsx)("circle",{cx:"9",cy:"6",r:"1.5"}),(0,k.jsx)("circle",{cx:"15",cy:"6",r:"1.5"}),(0,k.jsx)("circle",{cx:"9",cy:"12",r:"1.5"}),(0,k.jsx)("circle",{cx:"15",cy:"12",r:"1.5"}),(0,k.jsx)("circle",{cx:"9",cy:"18",r:"1.5"}),(0,k.jsx)("circle",{cx:"15",cy:"18",r:"1.5"})]})}),C&&(0,k.jsx)("svg",{className:"w-4 h-4 text-emerald-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})}),(0,k.jsx)("h3",{className:`text-sm font-medium leading-snug cursor-pointer ${N||C?"text-gray-400 dark:text-gray-500 line-through":"text-gray-900 dark:text-gray-100"}`,onClick:()=>{D>0&&d?d():v(!b)},children:e.title})]}),(0,k.jsx)("div",{className:"flex items-center gap-1 flex-shrink-0 ml-2",children:N?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),i?.(e.id)},className:"p-1.5 rounded-md hover:bg-emerald-50 dark:hover:bg-emerald-500/10 text-gray-400 dark:text-gray-500 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors",title:"Restore",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"p-1.5 rounded-md hover:bg-red-50 dark:hover:bg-red-500/10 text-gray-400 dark:text-gray-500 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:"Delete",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]}):(0,k.jsxs)(k.Fragment,{children:[!r&&s&&(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),s(e.id)},className:"p-1.5 rounded-md hover:bg-blue-50 dark:hover:bg-blue-500/10 text-gray-400 dark:text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 transition-colors",title:"Add sub-task",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),a(e)},className:"p-1.5 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800/80 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:"Edit",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z"})})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),n(e.id)},className:"p-1.5 rounded-md hover:bg-amber-50 dark:hover:bg-amber-500/10 text-gray-400 dark:text-gray-500 hover:text-amber-500 dark:hover:text-amber-400 transition-colors",title:"Archive",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"p-1.5 rounded-md hover:bg-red-50 dark:hover:bg-red-500/10 text-gray-400 dark:text-gray-500 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:"Delete",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]})})]}),(0,k.jsx)("p",{className:`text-xs text-gray-500 dark:text-gray-500 leading-relaxed mb-3 cursor-pointer ${b?"":"line-clamp-2"}`,onClick:()=>v(!b),children:e.description}),D>0&&(0,k.jsx)("div",{className:"mb-3",children:(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,k.jsx)("div",{className:"flex-1 bg-gray-200 dark:bg-gray-800 rounded-full h-1.5",children:(0,k.jsx)("div",{className:"bg-emerald-500 h-1.5 rounded-full transition-all",style:{width:`${Math.round(M/D*100)}%`}})}),(0,k.jsxs)("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:[M,"/",D]})]})}),(0,k.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("span",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400",children:[(0,k.jsx)("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.agentColor}}),e.agent]}),(0,k.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-800/80 text-gray-500 dark:text-gray-400 text-[10px] rounded-full font-medium",children:e.project}),D>0&&(0,k.jsxs)("span",{className:"px-2 py-0.5 bg-blue-50 dark:bg-blue-500/10 text-blue-500 dark:text-blue-400 text-[10px] rounded-full font-medium border border-blue-200 dark:border-blue-500/20 cursor-pointer",onClick:e=>{e.stopPropagation(),d?.()},children:[D," sub-task",1!==D?"s":""," ",c?"▾":"▸"]})]}),(0,k.jsx)("span",{className:"text-[10px] text-gray-400 dark:text-gray-600",children:E(e.createdAt)})]})]})});var tW=e.i(93610);function tz({id:e,children:t}){let{setNodeRef:r,isOver:a}=tf({id:`column:${e}`});return(0,k.jsx)("div",{ref:r,className:`min-h-[100px] transition-colors rounded-lg ${a?"bg-amber-50/50 dark:bg-amber-500/5":""}`,children:t})}function tF({id:e,isActive:t}){let{setNodeRef:r,isOver:a}=tf({id:e}),n=a||t;return(0,k.jsx)("div",{ref:r,className:"relative transition-all duration-150",style:{height:n?8:6,marginTop:-2,marginBottom:-2},children:n&&(0,k.jsxs)("div",{className:"absolute inset-x-2 top-1/2 -translate-y-1/2 h-[3px] bg-amber-500 rounded-full shadow-[0_0_8px_rgba(245,158,11,0.5)]",children:[(0,k.jsx)("div",{className:"absolute -left-1 top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-amber-500 rounded-full"}),(0,k.jsx)("div",{className:"absolute -right-1 top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-amber-500 rounded-full"})]})})}function tU({task:e,subTasks:t,isExpanded:r,onToggleExpand:a,dropTargetId:n,...l}){let{attributes:i,listeners:s,setNodeRef:o,transform:d,transition:c,isDragging:u}=tO({id:e.id,data:{type:"task",task:e}}),g={transform:er.Transform.toString(d),transition:c,opacity:u?.3:void 0};return(0,k.jsxs)("div",{children:[(0,k.jsx)(tB,{ref:o,style:g,task:e,subTasks:t,expanded:r,onToggleExpand:a,isDropTarget:n===e.id,dragHandleProps:{...i,...s},...l}),r&&t.map(e=>(0,k.jsx)(tH,{task:e,dropTargetId:n,...l},e.id))]})}function tH({task:e,dropTargetId:t,...r}){let{attributes:a,listeners:n,setNodeRef:l,transform:i,transition:s,isDragging:o}=tO({id:e.id,data:{type:"task",task:e}}),d={transform:er.Transform.toString(i),transition:s,opacity:o?.3:void 0};return(0,k.jsx)(tB,{ref:l,style:d,task:e,isSubTask:!0,isDropTarget:t===e.id,dragHandleProps:{...a,...n},...r})}let tY="drag-preview";function tX({tasks:e,onEditTask:t,onArchiveTask:r,onDeleteTask:a,onRestoreTask:n,onMoveTask:l,onReorderTask:i,onAddSubTask:s}){let{toast:o,dismiss:d}=(0,tW.useToast)(),[c,u]=(0,w.useState)(new Set),[g,h]=(0,w.useState)(null),[x,m]=(0,w.useState)(null),[f,p]=(0,w.useState)(null),[b,v]=(0,w.useState)(new Set),y=(0,w.useRef)(new Map),j=(0,w.useRef)(null);(0,w.useEffect)(()=>{let t=new Set,r=y.current;for(let a of e){let e=`${a.column}:${a.updatedAt||""}`,n=r.get(a.id);void 0!==n&&n!==e&&t.add(a.id)}let a=new Map;for(let t of e)a.set(t.id,`${t.column}:${t.updatedAt||""}`);if(y.current=a,t.size>0){v(t);let e=setTimeout(()=>v(new Set),1500);return()=>clearTimeout(e)}},[e]);let N=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,w.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(eg(e_,{activationConstraint:{distance:8}}),eg(eG,{activationConstraint:{delay:300,tolerance:5}})),C=(0,w.useMemo)(()=>e.filter(e=>!e.parentId),[e]),S=(0,w.useMemo)(()=>{let t=new Map;return e.filter(e=>e.parentId).forEach(e=>{let r=t.get(e.parentId)||[];r.push(e),t.set(e.parentId,r)}),t},[e]),E=g?e.find(e=>e.id===g):null,M=(0,w.useCallback)(e=>{u(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),D=(0,w.useCallback)(e=>{h(e.active.id)},[]),T=(0,w.useCallback)(t=>{let{over:r,active:a}=t;if(!r){m(null),p(null),d(tY);return}let n=r.id,l=e.find(e=>e.id===a.id),i=null,s=!1;if(n.startsWith("gap:"))p(n),m(null),i=n.split(":")[1];else if(n.startsWith("column:"))m(null),p(null),i=n.replace("column:","");else{m(n),p(null);let t=e.find(e=>e.id===n);t&&!t.parentId&&(s=!0),i=t?.column||null}if(l&&i)if(s){let t=e.find(e=>e.id===n);o(`→ Sub-task of "${t?.title}"`,{type:"preview",id:tY})}else if(i!==l.column){let e;o(`→ ${(e=i,tP.find(t=>t.id===e)?.title||e)}`,{type:"preview",id:tY})}else d(tY)},[e,o,d]),L=(0,w.useCallback)(t=>{let{active:r,over:a}=t;if(h(null),m(null),p(null),d(tY),!a)return;let n=r.id,s=a.id,o=e.find(e=>e.id===n);if(o){if(s.startsWith("gap:")){let t=s.split(":"),r=t[1],a=parseInt(t[2]);if(o.parentId){let t=e.find(e=>e.id===o.parentId);if(t?.column==="suggested"&&"suggested"!==r)return}i&&i(n,r,a);return}if(l)if(s.startsWith("column:")){let t=s.replace("column:","");if(o.parentId){let r=e.find(e=>e.id===o.parentId);if(r?.column==="suggested"&&"suggested"!==t)return}o.column!==t&&l(n,t,o.parentId)}else{let t=e.find(e=>e.id===s);if(t&&n!==s){if(t.parentId||o.parentId===s)return;l(n,t.column,s)}}}},[l,i,e]),R=(0,w.useCallback)(()=>{h(null),m(null),p(null),d(tY)},[d]);return(0,k.jsxs)(tg,{sensors:N,collisionDetection:ep,onDragStart:D,onDragOver:T,onDragEnd:L,onDragCancel:R,autoScroll:{enabled:!0,threshold:{x:.05,y:.15},interval:10,acceleration:5},children:[(0,k.jsx)("div",{ref:j,className:"flex gap-4 overflow-x-auto pb-4 lg:grid lg:grid-cols-6 lg:overflow-x-visible",children:tP.map(e=>{let l=C.filter(t=>t.column===e.id);return(0,k.jsxs)("div",{className:"flex-shrink-0 w-[85vw] sm:w-[70vw] lg:w-auto rounded-xl border border-gray-200 dark:border-gray-800/50 bg-gray-50/50 dark:bg-gray-950/30 p-3 flex flex-col",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-3 px-1 sticky top-0 z-10 bg-gray-50/95 dark:bg-gray-950/95 backdrop-blur-sm py-2 -mt-1 rounded-lg",children:[(0,k.jsx)("span",{className:`w-2.5 h-2.5 rounded-full ${e.dotColor}`}),(0,k.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e.title}),(0,k.jsx)("span",{className:"text-xs text-gray-400 dark:text-gray-600 ml-1",children:l.length})]}),(0,k.jsx)(tz,{id:e.id,children:0!==l.length||g?(0,k.jsxs)("div",{className:"space-y-1",children:[l.map((l,i)=>{let o=S.get(l.id)||[];return(0,k.jsxs)("div",{children:[g&&(0,k.jsx)(tF,{id:`gap:${e.id}:${i}`,isActive:f===`gap:${e.id}:${i}`}),(0,k.jsx)(tU,{task:l,subTasks:o,isExpanded:c.has(l.id),onToggleExpand:()=>M(l.id),dropTargetId:x,onEdit:t,onArchive:r,onDelete:a,onRestore:n,onAddSubTask:s,animateIn:b.has(l.id)})]},l.id)}),g&&(0,k.jsx)(tF,{id:`gap:${e.id}:${l.length}`,isActive:f===`gap:${e.id}:${l.length}`})]}):(0,k.jsx)("div",{className:"border-2 border-dashed border-gray-200 dark:border-gray-800/30 rounded-xl p-6 text-center",children:(0,k.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-600",children:"No tasks"})})})]},e.id)})}),(0,k.jsx)(tC,{children:E?(0,k.jsx)(tB,{task:E,subTasks:S.get(E.id)||[],isDragOverlay:!0,onEdit:()=>{},onArchive:()=>{},onDelete:()=>{}}):null})]})}let tK={Ezra:"bg-amber-400"};function tV({activities:e}){return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-900/40 backdrop-blur-sm border border-gray-200 dark:border-gray-800/50 rounded-xl p-4",children:[(0,k.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4 flex items-center gap-2",children:[(0,k.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-400 animate-pulse"}),"Activity"]}),(0,k.jsxs)("div",{className:"space-y-4",children:[e.map(e=>(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsxs)("div",{className:"flex flex-col items-center",children:[(0,k.jsx)("div",{className:`w-2 h-2 rounded-full mt-1.5 flex-shrink-0 ${tK[e.agent]||"bg-gray-400 dark:bg-gray-700"}`}),(0,k.jsx)("div",{className:"w-px flex-1 bg-gray-200 dark:bg-gray-800/50"})]}),(0,k.jsxs)("div",{className:"pb-4",children:[(0,k.jsx)("p",{className:"text-[10px] text-amber-500 dark:text-amber-400/70 font-medium mb-0.5",children:e.agent}),(0,k.jsx)("p",{className:"text-xs text-gray-700 dark:text-gray-300 leading-relaxed",children:e.message}),(0,k.jsx)("p",{className:"text-[10px] text-gray-400 dark:text-gray-600 mt-1",children:E(e.timestamp)})]})]},e.id)),0===e.length&&(0,k.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-600 text-center py-4",children:"No activity yet"})]})]})}function tJ({isOpen:e,onClose:t,onSave:r,editingTask:a,projects:n,tasks:l,preselectedParentId:i}){let[s,o]=(0,w.useState)(""),[d,c]=(0,w.useState)(""),[u,g]=(0,w.useState)("backlog"),[h,x]=(0,w.useState)("Ezra"),[m,f]=(0,w.useState)(""),[p,b]=(0,w.useState)(""),[v,y]=(0,w.useState)(!1),[j,N]=(0,w.useState)(null);if((0,w.useEffect)(()=>{if(a)o(a.title),c(a.description),g(a.column),x(a.agent),f(a.project),b(a.parentId||"");else{o(""),c("");let e=i?l.find(e=>e.id===i):null;g(e?e.column:"backlog"),x("Ezra"),f(e?e.project:n[0]?.id||""),b(i||"")}N(null),y(!1)},[a,e,n]),!e)return null;let C=l.filter(e=>!e.parentId&&e.id!==a?.id),S=!!p,E=p?l.find(e=>e.id===p):null,M=async e=>{if(e.preventDefault(),s.trim()){y(!0),N(null);try{await r({title:s,description:d,column:u,agent:h,agentColor:"#f59e0b",project:m||n[0]?.id||"",parentId:p||null}),t()}catch(e){N(e instanceof Error?e.message:"Failed to save task")}finally{y(!1)}}},D="w-full bg-gray-100 dark:bg-gray-800/60 border border-gray-300 dark:border-gray-700/50 text-gray-900 dark:text-gray-200 text-sm rounded-lg px-3 py-2.5 focus:outline-none focus:border-amber-500/50 transition-colors min-h-[44px]";return(0,k.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:v?void 0:t}),(0,k.jsx)("div",{className:"relative bg-white dark:bg-gray-900/95 backdrop-blur-xl border border-gray-200 dark:border-gray-800/50 rounded-2xl w-full max-w-lg shadow-2xl",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6",children:a?"Edit Task":"New Task"}),j&&(0,k.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/20 rounded-lg text-sm text-red-600 dark:text-red-400",children:j}),(0,k.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs text-gray-500 mb-1.5",children:"Title"}),(0,k.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),className:D,placeholder:"What needs to be done?",autoFocus:!0,disabled:v})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs text-gray-500 mb-1.5",children:"Description"}),(0,k.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),className:`${D} min-h-[88px] resize-none`,placeholder:"Add details...",rows:3,disabled:v})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs text-gray-500 mb-1.5",children:"Column"}),(0,k.jsx)("select",{value:u,onChange:e=>g(e.target.value),className:D,disabled:v,children:tP.filter(e=>"archived"!==e.id&&(!S||E?.column!=="suggested"||"suggested"===e.id)).map(e=>(0,k.jsx)("option",{value:e.id,children:e.title},e.id))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs text-gray-500 mb-1.5",children:"Project"}),(0,k.jsx)("select",{value:m,onChange:e=>f(e.target.value),className:D,disabled:v,children:n.map(e=>(0,k.jsx)("option",{value:e.id,children:e.name},e.id))})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs text-gray-500 mb-1.5",children:"Parent task (optional)"}),(0,k.jsxs)("select",{value:p,onChange:e=>b(e.target.value),className:D,disabled:v,children:[(0,k.jsx)("option",{value:"",children:"None (top-level task)"}),C.map(e=>(0,k.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,k.jsx)("button",{type:"button",onClick:t,disabled:v,className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors min-h-[44px] disabled:opacity-50",children:"Cancel"}),(0,k.jsxs)("button",{type:"submit",disabled:v,className:"px-5 py-2 bg-amber-500 hover:bg-amber-400 text-gray-950 font-semibold text-sm rounded-lg transition-colors min-h-[44px] disabled:opacity-70 flex items-center gap-2",children:[v&&(0,k.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,k.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,k.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),a?"Save Changes":"Create Task"]})]})]})]})})]})}let t_=["#f59e0b","#3b82f6","#10b981","#8b5cf6","#6366f1","#ec4899","#ef4444","#14b8a6","#f97316","#84cc16"],tq=[{value:"active",label:"Active"},{value:"suggested",label:"Suggested"},{value:"completed",label:"Completed"},{value:"archived",label:"Archived"}];function tG({isOpen:e,onClose:t,onSave:r,editingProject:a}){let[n,l]=(0,w.useState)(""),[i,s]=(0,w.useState)(""),[o,d]=(0,w.useState)(t_[0]),[c,u]=(0,w.useState)("active");return((0,w.useEffect)(()=>{a?(l(a.name),s(a.description),d(a.color),u(a.status||"active")):(l(""),s(""),d(t_[Math.floor(Math.random()*t_.length)]),u("active"))},[a,e]),e)?(0,k.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n.trim()&&(r({name:n.trim(),description:i.trim(),color:o,status:c}),t())},className:"relative bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800/50 shadow-xl w-full max-w-md p-6 space-y-4",children:[(0,k.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a?"Edit Project":"New Project"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Name"}),(0,k.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-800/60 border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-500/50",placeholder:"Project name",autoFocus:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Description"}),(0,k.jsx)("textarea",{value:i,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-800/60 border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-500/50 resize-none",rows:2,placeholder:"Brief description"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Color"}),(0,k.jsx)("div",{className:"flex gap-2 flex-wrap",children:t_.map(e=>(0,k.jsx)("button",{type:"button",onClick:()=>d(e),className:`w-7 h-7 rounded-full transition-all ${o===e?"ring-2 ring-offset-2 ring-amber-500 dark:ring-offset-gray-900 scale-110":"hover:scale-110"}`,style:{backgroundColor:e}},e))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Status"}),(0,k.jsx)("select",{value:c,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-800/60 border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-500/50",children:tq.map(e=>(0,k.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,k.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:"Cancel"}),(0,k.jsx)("button",{type:"submit",className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white text-sm font-medium rounded-lg transition-colors",children:a?"Save":"Create"})]})]})]}):null}let tQ=[{status:"active",label:"Active Projects",icon:"🚀",emptyText:"No active projects"},{status:"suggested",label:"Suggested",icon:"💡",emptyText:"No suggested projects"},{status:"completed",label:"Completed",icon:"✅",emptyText:"No completed projects"},{status:"archived",label:"Archived",icon:"📦",emptyText:"No archived projects"}];function tZ({projects:e,tasks:t,onEditTask:r,onArchiveTask:a,onDeleteTask:n,onRestoreTask:l,onMoveTask:i,onReorderTask:s,onAddSubTask:o,onNewProject:d,onEditProject:c,onUpdateProjectStatus:u}){let[g,h]=(0,w.useState)(null),[x,m]=(0,w.useState)(new Set(["completed","archived"]));if(g){let d=e.find(e=>e.id===g),u=t.filter(e=>e.project===g);return(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("button",{onClick:()=>h(null),className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors min-h-[44px]",children:[(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),"Back to projects"]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[(0,k.jsx)("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d?.color}}),d?.name,d?.status&&(0,k.jsx)("span",{className:"text-xs font-normal px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:d.status})]}),d&&c&&(0,k.jsx)("button",{onClick:()=>c(d),className:"text-xs text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:"Edit project"})]}),(0,k.jsx)(tX,{tasks:u,onEditTask:r,onArchiveTask:a,onDeleteTask:n,onRestoreTask:l,onMoveTask:i,onReorderTask:s,onAddSubTask:o})]})}return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Projects"}),d&&(0,k.jsxs)("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white text-sm font-medium rounded-lg transition-colors",children:[(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"New Project"]})]}),tQ.map(({status:r,label:a,icon:n,emptyText:l})=>{let i=e.filter(e=>(e.status||"active")===r),s=x.has(r);return(0,k.jsxs)("div",{children:[(0,k.jsxs)("button",{onClick:()=>{m(e=>{let t=new Set(e);return t.has(r)?t.delete(r):t.add(r),t})},className:"flex items-center gap-2 mb-3 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-colors",children:[(0,k.jsx)("span",{children:n}),(0,k.jsx)("span",{children:a}),(0,k.jsxs)("span",{className:"text-xs text-gray-400 dark:text-gray-600",children:["(",i.length,")"]}),(0,k.jsx)("svg",{className:`w-3.5 h-3.5 transition-transform ${s?"":"rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})})]}),!s&&(i.length>0?(0,k.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(e=>{let a=t.filter(t=>t.project===e.id).filter(e=>"archived"!==e.column),n=a.filter(e=>"backlog"===e.column).length,l=a.filter(e=>"in-progress"===e.column||"review"===e.column).length,i=a.filter(e=>"done"===e.column).length,s=a.length,o=s>0?Math.round(i/s*100):0;return(0,k.jsxs)("div",{className:"relative text-left bg-white dark:bg-gray-900/60 border border-gray-200 dark:border-gray-800/50 rounded-xl p-5 hover:border-amber-400 dark:hover:border-amber-500/30 hover:shadow-lg transition-all duration-200",style:{borderLeftColor:e.color,borderLeftWidth:4},children:[(0,k.jsxs)("button",{onClick:()=>h(e.id),className:"block w-full text-left",children:[(0,k.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-1",children:e.name}),(0,k.jsx)("p",{className:"text-xs text-gray-500 mb-4 line-clamp-2",children:e.description}),(0,k.jsxs)("div",{className:"flex items-center gap-3 text-[11px]",children:[(0,k.jsxs)("span",{className:"text-gray-400",children:[n," backlog"]}),(0,k.jsxs)("span",{className:"text-blue-500 dark:text-blue-400",children:[l," active"]}),(0,k.jsxs)("span",{className:"text-emerald-500 dark:text-emerald-400",children:[i," done"]})]}),(0,k.jsx)("div",{className:"mt-3 w-full bg-gray-200 dark:bg-gray-800 rounded-full h-1.5",children:(0,k.jsx)("div",{className:"bg-emerald-500 h-1.5 rounded-full transition-all",style:{width:`${o}%`}})}),(0,k.jsxs)("p",{className:"text-[10px] text-gray-400 dark:text-gray-600 mt-1",children:[o,"% complete · ",s," tasks"]})]}),u&&(0,k.jsxs)("div",{className:"absolute top-3 right-3 flex items-center gap-1",children:["active"!==r&&(0,k.jsx)("button",{onClick:()=>u(e.id,"active"),className:"p-1 rounded text-[10px] text-gray-400 hover:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-500/10 transition-colors",title:"Activate",children:"🚀"}),"completed"!==r&&(0,k.jsx)("button",{onClick:()=>u(e.id,"completed"),className:"p-1 rounded text-[10px] text-gray-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-500/10 transition-colors",title:"Complete",children:"✅"}),"archived"!==r&&(0,k.jsx)("button",{onClick:()=>u(e.id,"archived"),className:"p-1 rounded text-[10px] text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 transition-colors",title:"Archive",children:"📦"})]})]},e.id)})}):(0,k.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-600 pl-6",children:l}))]},r)})]})}function t0(){let[e,t]=(0,w.useState)([]),[r,a]=(0,w.useState)({});(0,w.useEffect)(()=>{Promise.resolve([{id:"morning-brief",name:"Morning Brief",description:"Daily briefing at 9am ET",schedule:"0 14 * * *",enabled:!0,lastRun:null,status:"active",nextRun:"",type:"cron"},{id:"work-sprint",name:"Work Sprint",description:"4x daily autonomous work sessions",schedule:"0 15,18,21,0 * * *",enabled:!0,lastRun:null,status:"active",nextRun:"",type:"cron"},{id:"idea-generator",name:"Idea Generator",description:"M/W/F business ideas",schedule:"0 16 * * 1,3,5",enabled:!0,lastRun:null,status:"active",nextRun:"",type:"cron"},{id:"health-check",name:"System Health Check",description:"Every 30min infra check",schedule:"*/30 * * * *",enabled:!0,lastRun:null,status:"active",nextRun:"",type:"cron"},{id:"eod-report",name:"EOD Report",description:"End of day summary",schedule:"0 23 * * 1-5",enabled:!0,lastRun:null,status:"active",nextRun:"",type:"cron"}]).then(e=>{t(e);let r={};e.forEach(e=>{r[e.id]="active"===e.status}),a(r)})},[]);let n=e.length,l=Object.values(r).filter(Boolean).length,i=e.filter(e=>"cron"===e.type).length,s=e.filter(e=>"heartbeat"===e.type).length;return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Automations"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Crons, heartbeats, and scheduled workflows"})]}),(0,k.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{label:"Total",value:n,color:"text-gray-900 dark:text-gray-100"},{label:"Active",value:l,color:"text-emerald-500 dark:text-emerald-400"},{label:"Cron Jobs",value:i,color:"text-blue-500 dark:text-blue-400"},{label:"Heartbeats",value:s,color:"text-amber-500 dark:text-amber-400"}].map(e=>(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-900/40 backdrop-blur-sm border border-gray-200 dark:border-gray-800/50 rounded-xl p-4",children:[(0,k.jsx)("div",{className:`text-2xl font-bold ${e.color}`,children:e.value}),(0,k.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.label})]},e.label))}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.map(e=>{let t=r[e.id]??!0;return(0,k.jsxs)("div",{className:"group bg-white dark:bg-gray-900/40 backdrop-blur-sm border border-gray-200 dark:border-gray-800/50 rounded-xl p-5 transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-700/60 hover:shadow-lg dark:hover:shadow-amber-500/5",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2.5 min-w-0",children:[(0,k.jsx)("span",{className:"relative flex h-2.5 w-2.5 flex-shrink-0",children:t?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),(0,k.jsx)("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-emerald-500"})]}):(0,k.jsx)("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-gray-400 dark:bg-gray-600"})}),(0,k.jsx)("h3",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100 truncate",children:e.name})]}),(0,k.jsx)("span",{className:`flex-shrink-0 text-[10px] font-medium px-2 py-0.5 rounded-full ${"cron"===e.type?"bg-blue-50 dark:bg-blue-500/15 text-blue-500 dark:text-blue-400 border border-blue-200 dark:border-blue-500/20":"bg-amber-50 dark:bg-amber-500/15 text-amber-500 dark:text-amber-400 border border-amber-200 dark:border-amber-500/20"}`,children:e.type})]}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 line-clamp-2 mb-3 leading-relaxed",children:e.description}),(0,k.jsx)("div",{className:"text-[11px] font-mono text-gray-500 mb-1",children:e.schedule}),(0,k.jsxs)("div",{className:"text-[11px] text-gray-400 dark:text-gray-600 mb-4",children:["Next: ",e.nextRun]}),(0,k.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-800/40",children:[(0,k.jsx)("span",{className:"text-[11px] text-gray-500",children:t?"Enabled":"Disabled"}),(0,k.jsx)("button",{onClick:()=>a(t=>({...t,[e.id]:!t[e.id]})),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors duration-200 ${t?"bg-emerald-500/80":"bg-gray-300 dark:bg-gray-700"}`,children:(0,k.jsx)("span",{className:`inline-block h-3.5 w-3.5 rounded-full bg-white transition-transform duration-200 ${t?"translate-x-[18px]":"translate-x-[3px]"}`})})]})]},e.id)})})]})}let t1=["tasks","projects","automations","team"];function t2(){let e=window.location.hash.replace("#","");return t1.includes(e)?e:"tasks"}let t5=e=>tP.find(t=>t.id===e)?.title||e;function t4(){let{toast:e}=(0,tW.useToast)(),[t,r]=(0,w.useState)("tasks"),[a,n]=(0,w.useState)(!1),[l,i]=(0,w.useState)([]),[s,o]=(0,w.useState)([]),[d,c]=(0,w.useState)([]),[u,g]=(0,w.useState)(!1),[h,x]=(0,w.useState)(null),[m,f]=(0,w.useState)(null),[p,b]=(0,w.useState)(null),[v,y]=(0,w.useState)(null),[E,M]=(0,w.useState)(!1),[T,I]=(0,w.useState)(null);(0,w.useEffect)(()=>{r(t2());let e=()=>r(t2());return window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)},[]);let O=(0,w.useCallback)(e=>{window.location.hash=e},[]),P=(0,w.useCallback)(async()=>{try{let[e,t,r]=await Promise.all([j("/api/tasks"),j("/api/projects"),j("/api/activities")]);i(e),o(t),c(r)}catch(e){console.error("Failed to load data:",e)}},[]);(0,w.useEffect)(()=>{P()},[P]);let $=l.filter(e=>(!p||e.agent===p)&&(!v||e.project===v)),B=(0,w.useCallback)(()=>{x(null),f(null),g(!0)},[]),W=(0,w.useCallback)(e=>{x(null),f(e),g(!0)},[]),z=(0,w.useCallback)(e=>{x(e),g(!0)},[]),F=(0,w.useCallback)(async t=>{try{let r=l.find(e=>e.id===t);if(!r)return;let a="archived"!==r.column?r.column:"backlog";for(let e of(await C(t,{column:"archived",previousColumn:a}),l.filter(e=>e.parentId===t))){let t="archived"!==e.column?e.column:"backlog";await C(e.id,{column:"archived",previousColumn:t})}await P(),e("Archived",{type:"warning",action:{label:"Undo",onClick:async()=>{try{for(let e of(await C(t,{column:a,previousColumn:null}),(await j("/api/tasks")).filter(e=>e.parentId===t&&"archived"===e.column)))await C(e.id,{column:e.previousColumn||a,previousColumn:null});await P(),e("Restored",{type:"success"})}catch{e("Failed",{type:"error"})}}}})}catch(e){console.error("Failed to archive task:",e)}},[P,l,e]),U=(0,w.useCallback)(async t=>{try{let r=l.find(e=>e.id===t);if(!r)return;let a=[...l.filter(e=>e.parentId===t)];await j(`/api/tasks/?id=${t}`,{method:"DELETE"}),await P(),e("Deleted",{type:"error",durationMs:8e3,action:{label:"Undo",onClick:async()=>{try{let t=await N({title:r.title,description:r.description,column:r.column,agent:r.agent,agentColor:r.agentColor,project:r.project,parentId:r.parentId});for(let e of a)await N({title:e.title,description:e.description,column:e.column,agent:e.agent,agentColor:e.agentColor,project:e.project,parentId:t.id});await P(),e("Restored",{type:"success"})}catch{e("Restore failed",{type:"error"})}}}})}catch(e){console.error("Failed to delete task:",e)}},[P,l,e]),H=(0,w.useCallback)(async t=>{try{let r=await j("/api/tasks"),a=r.find(e=>e.id===t);if(!a)return;let n=a.previousColumn||"backlog";for(let e of(await C(t,{column:n,previousColumn:null}),r.filter(e=>e.parentId===t&&"archived"===e.column))){let t=e.previousColumn||n;await C(e.id,{column:t,previousColumn:null})}await P(),e(`Restored → ${t5(n)}`,{type:"success"})}catch(e){console.error("Failed to restore task:",e)}},[P,e]),[Y,X]=(0,w.useState)(!1),K=(0,w.useCallback)(async(t,r,a)=>{try{let n,i=["suggested","backlog","in-progress","review","done","archived"],s=l.find(e=>e.id===t);if(!s)return;let o={column:r};void 0!==a&&(o.parentId=a);let d=i.indexOf(r)>(n=s.column,i.indexOf(n));if(s.parentId){let n=l.find(e=>e.id===s.parentId);if(n&&"suggested"===n.column&&"suggested"!==r)return;if(a&&a!==s.parentId){let e=l.find(e=>e.id===a);e&&(o.column=e.column)}let i=s.column,d=o.column||r;if(await C(t,o),a&&a!==s.parentId?(l.find(e=>e.id===a),e("Added as sub-task",{type:"info"})):i!==d&&e(`Moved → ${t5(d)}`,{type:"info"}),"done"===r&&s.parentId){let r=l.filter(e=>e.parentId===s.parentId&&e.id!==t).every(e=>"done"===e.column),a=l.find(e=>e.id===s.parentId);r&&a&&"done"!==a.column&&confirm(`All sub-tasks are now done. Mark "${a.title}" as done too?`)&&(await C(a.id,{column:"done"}),e(`Parent completed ✓`,{type:"success"}))}await P();return}let c=l.filter(e=>e.parentId===t);if("archived"===r){if(c.length>0&&!confirm(`This will also archive ${c.length} sub-task${c.length>1?"s":""}. Continue?`))return;for(let e of(await C(t,o),c))await C(e.id,{column:"archived"})}else if(d){if("done"===r&&c.length>0){let e=c.filter(e=>"done"!==e.column);if(e.length>0){if(!confirm(`${e.length} sub-task${e.length>1?"s are":" is"} not done yet. Mark all as done?`))return;for(let t of e)await C(t.id,{column:"done"})}}else for(let e of c.filter(e=>{let t;return t=e.column,i.indexOf(t)<i.indexOf(r)&&"done"!==e.column}))await C(e.id,{column:r});await C(t,o)}else{let e=c.filter(e=>{let t;return t=e.column,i.indexOf(t)>i.indexOf(r)});if(e.length>0){let t=t5(r);if(!confirm(`Moving backward will also move ${e.length} sub-task${e.length>1?"s":""} back to "${t}". Continue?`))return;for(let t of e)await C(t.id,{column:r})}await C(t,o)}s.column!==r&&e(`Moved → ${t5(r)}`,{type:"done"===r?"success":"info"}),await P()}catch(e){console.error("Failed to move task:",e)}},[P,l,e]),V=(0,w.useCallback)(async(t,r,a)=>{try{let n=l.find(e=>e.id===t);await j("/api/tasks",{method:"PATCH",body:JSON.stringify({id:t,column:r,index:a})}),await P(),n&&n.column!==r&&e(`Moved → ${t5(r)}`,{type:"info"})}catch(e){console.error("Failed to reorder task:",e)}},[P,l,e]),J=(0,w.useCallback)(()=>{I(null),M(!0)},[]),_=(0,w.useCallback)(e=>{I(e),M(!0)},[]),q=(0,w.useCallback)(async e=>{try{if(T)await S(T.id,e);else await j("/api/projects",{method:"POST",body:JSON.stringify(e)});await P()}catch(e){console.error("Failed to save project:",e)}},[T,P]),G=(0,w.useCallback)(async(e,t)=>{try{await S(e,{status:t}),await P()}catch(e){console.error("Failed to update project status:",e)}},[P]),Q=(0,w.useCallback)(async e=>{h?await C(h.id,e):await N(e),await P()},[h,P]);return(0,k.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[(0,k.jsx)(D,{activeTab:t,onTabChange:O}),a&&(0,k.jsxs)("div",{className:"fixed inset-0 z-40 md:hidden",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>n(!1)}),(0,k.jsxs)("aside",{className:"absolute left-0 top-0 bottom-0 w-64 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border-r border-gray-200 dark:border-gray-800/50 z-50",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800/50",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-lg",children:"⚡"}),(0,k.jsx)("span",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:"Mission Control"})]}),(0,k.jsx)("button",{onClick:()=>n(!1),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800/60 text-gray-500 dark:text-gray-400 min-w-[44px] min-h-[44px] flex items-center justify-center",children:(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,k.jsx)("nav",{className:"p-3 space-y-1",children:[{id:"tasks",label:"Tasks"},{id:"projects",label:"Projects"},{id:"automations",label:"Automations"},{id:"team",label:"Team"}].map(e=>(0,k.jsx)("a",{href:`#${e.id}`,onClick:t=>{t.preventDefault(),O(e.id),n(!1)},className:`block w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all min-h-[44px] ${t===e.id?"bg-amber-500/10 text-amber-500 dark:text-amber-400 border border-amber-500/20":"text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800/40"}`,children:e.label},e.id))})]})]}),(0,k.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,k.jsx)(L,{onMenuToggle:()=>n(!0)}),"tasks"===t?(0,k.jsxs)("main",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,k.jsxs)("div",{className:"flex flex-col lg:flex-row flex-1 min-h-0",children:[(0,k.jsxs)("div",{className:"flex-1 p-4 md:p-6 space-y-5 overflow-y-auto",children:[(0,k.jsx)(R,{tasks:l}),(0,k.jsx)(A,{selectedAgent:p,selectedProject:v,onAgentChange:b,onProjectChange:y,onNewTask:B,projects:s,tasks:l}),(0,k.jsx)(tX,{tasks:$,onEditTask:z,onArchiveTask:F,onDeleteTask:U,onRestoreTask:H,onMoveTask:K,onReorderTask:V,onAddSubTask:W})]}),(0,k.jsx)("div",{className:"hidden lg:block w-72 xl:w-80 flex-shrink-0 p-6 pl-0",children:(0,k.jsx)(tV,{activities:d})})]}),(0,k.jsxs)("div",{className:"lg:hidden border-t border-gray-200 dark:border-gray-800/50 flex-shrink-0",children:[(0,k.jsxs)("button",{onClick:()=>X(!Y),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:[(0,k.jsxs)("span",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-400 animate-pulse"}),"Activity (",d.length,")"]}),(0,k.jsx)("svg",{className:`w-4 h-4 transition-transform ${Y?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"})})]}),Y&&(0,k.jsx)("div",{className:"max-h-[150px] overflow-y-auto px-4 pb-3",children:(0,k.jsx)(tV,{activities:d})})]})]}):"projects"===t?(0,k.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,k.jsx)(tZ,{projects:s,tasks:l,onEditTask:z,onArchiveTask:F,onDeleteTask:U,onRestoreTask:H,onMoveTask:K,onReorderTask:V,onAddSubTask:W,onNewProject:J,onEditProject:_,onUpdateProjectStatus:G})}):"automations"===t?(0,k.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,k.jsx)(t0,{})}):(0,k.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-900/40 backdrop-blur-sm border border-gray-200 dark:border-gray-800/50 rounded-xl p-8 text-center",children:[(0,k.jsx)("div",{className:"text-4xl mb-4",children:"🤖"}),(0,k.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-200 mb-2",children:"Team"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 max-w-md mx-auto",children:"Your AI sub-agents and team members will appear here. This view is coming soon as your agent team grows."})]})})]}),(0,k.jsx)(tJ,{isOpen:u,onClose:()=>{g(!1),x(null),f(null)},onSave:Q,editingTask:h,projects:s,tasks:l,preselectedParentId:m}),(0,k.jsx)(tG,{isOpen:E,onClose:()=>{M(!1),I(null)},onSave:q,editingProject:T})]})}e.s(["default",()=>t4],31713)}]);